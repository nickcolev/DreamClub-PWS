<html><head><title>PWS Method test</title>
<link href="/nick.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
var xmlReg = null;		// Global xmlHttpRequest
function del(url) {
	xhr("DELETE", url, null);
}
function get() {
	xhr("GET", "/test.htm", null);
}
function head() {
	xhr("HEAD", "/tmp/shell.cgi", null);
}
function options(resource) {
	xhr("OPTIONS", resource, null);
}
function trace() {
	xhr("TRACE", "/test.htm", null);
}
function post() {
	xhr("POST", "/tmp/shell.cgi", "method=POST");
}
function put() {
	xhr("PUT", "/put.txt", "PUTÀÁÂ\n");
}
function put2() {
	var file = document.getElementById("file");
    var f = file.files[0];
	var reader = new FileReader();
	reader.onloadend = function(e){
		//console.log(reader.result);
		xhr("PUT", "/"+f.name, reader.result);
	}
	reader.readAsBinaryString(f);
console.log(f.name, f.size, "bytes", f.type);
}
function xhr(method, resource, data) {
  if (!xmlReg) xmlReg = new XMLHttpRequest();
  else if (xmlReg.readyState != 0) xmlReg.abort();
  //xmlReg.overrideMimeType("text/plain");
  xmlReg.onreadystatechange = function() {
    if (xmlReg.readyState == 4) {
		alert(xmlReg.status+": "+xmlReg.responseText);
	}
  }
  var url = document.getElementById("host").value.replace(/\/$/, "");
console.log("CP83:", url+resource);
  xmlReg.open(method, url+resource, true);
  if(method === "POST") xmlReg.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  xmlReg.send(data);
}
</script>
</head>
<body>

<h1>APWS method test</h1>

<form name="opt"><input id="host" value="http://192.168.1.12:8080"/></form>

<ul>
 <li><a href="javascript:get()">GET</a></li>
 <li><a href="javascript:head()">HEAD</a></li>
 <li><a href="javascript:options('/*')">OPTIONS</a><br/><small><a href="javascript:options('/tmp')">/tmp</a>, <a href="javascript:options('/test.htm')">/test.htm</a>, <a href="javascript:options('/foo')">/foo</a></small></li>
 <li><a href="javascript:trace()">TRACE</a></li>
 <li><a href="form.htm">POST</a></li>
 <li><a href="javascript:put()">PUT</a></li>
 <li><a href="javascript:del('/put.txt')">DELETE</a></li>
</ul>

<form onsubmit="return false">
 <input type="file" id="file"/>
 <input type="button" value=" PUT " onclick="put2()"/>
</form>

</body></html>
